[[rich-version-constraints]]
= å£°æ˜è¯¦ç»†çš„ç‰ˆæœ¬

Gradle æ”¯æŒç”¨äºå£°æ˜ç‰ˆæœ¬çš„ä¸°å¯Œæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å…è®¸ç»„åˆä¸åŒçº§åˆ«çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚ æœ¯è¯­åŠå…¶å«ä¹‰å¦‚ä¸‹ï¼ˆä»æœ€å¼ºåˆ°æœ€å¼±ï¼‰ï¼š

[[sec:strict-version]]
`strictly`::
ä¸è¯¥ç‰ˆæœ¬ç¬¦å·ä¸åŒ¹é…çš„ä»»ä½•ç‰ˆæœ¬å°†è¢«æ’é™¤ã€‚ è¿™æ˜¯ `strictly` çš„ç‰ˆæœ¬å£°æ˜ã€‚ åœ¨å£°æ˜çš„ä¾èµ–ä¸Šï¼Œä¸¥æ ¼å¯ä»¥é™çº§ç‰ˆæœ¬ã€‚ åœ¨ä¼ é€’ä¾èµ–ä¸Šï¼Œå¦‚æœæ— æ³•é€‰æ‹©æ­¤å­å¥å¯æ¥å—çš„ç‰ˆæœ¬ï¼Œå°†å¯¼è‡´ä¾èµ–è§£æå¤±è´¥ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ <<dependency_downgrade_and_exclude.adoc#sec:enforcing_dependency_version,overriding dependency version>>ã€‚ è¯¥æœ¯è¯­æ”¯æŒåŠ¨æ€ç‰ˆæœ¬ã€‚
+
å®šä¹‰åï¼Œå°†è¦†ç›–å…ˆå‰çš„ `require`  å£°æ˜å¹¶æ¸…é™¤å…ˆå‰çš„ `reject`

[[sec:required-version]]
`require`::
è¡¨ç¤ºæ‰€é€‰ç‰ˆæœ¬ä¸èƒ½ä½äº `require` æ¥å—çš„ç‰ˆæœ¬ï¼Œä½†å¯ä»¥é€šè¿‡å†²çªè§£å†³æ–¹æ¡ˆæé«˜ï¼Œå³ä½¿æ›´é«˜ç‰ˆæœ¬å…·æœ‰æ’ä»–æ€§æ›´é«˜çš„ç•Œé™ã€‚ è¿™å°±æ˜¯ä¾èµ–ä¸Šçš„ç›´æ¥ç‰ˆæœ¬æ‰€è½¬æ¢çš„å†…å®¹ã€‚ è¯¥æœ¯è¯­æ”¯æŒåŠ¨æ€ç‰ˆæœ¬ã€‚
+
å®šä¹‰åï¼Œå°†è¦†ç›–å…ˆå‰çš„ `strictly` å£°æ˜å¹¶æ¸…é™¤å…ˆå‰çš„ `reject`ã€‚

[[sec:preferred-version]]
`prefer`::
è¿™æ˜¯ä¸€ä¸ªéå¸¸è½¯çš„ç‰ˆæœ¬å£°æ˜ã€‚ ä»…å½“å¯¹è¯¥æ¨¡å—çš„ç‰ˆæœ¬æ²¡æœ‰æ›´å¼ºçš„éåŠ¨æ€è§‚ç‚¹æ—¶ï¼Œæ‰é€‚ç”¨ã€‚ è¯¥æœ¯è¯­ä¸æ”¯æŒåŠ¨æ€ç‰ˆæœ¬ã€‚
+
å®šä¹‰å¯ä»¥ `strictly` or `require`ã€‚

åœ¨çº§åˆ«å±‚æ¬¡ç»“æ„ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªé™„åŠ æœ¯è¯­:

[[sec:rejected-version]]
`reject`::
å£°æ˜æ¨¡å—ä¸æ¥å—ç‰¹å®šç‰ˆæœ¬ã€‚å¦‚æœå”¯ä¸€çš„å¯é€‰ç‰ˆæœ¬ä¹Ÿè¢«æ‹’ç»ï¼Œè¿™å°†å¯¼è‡´ä¾èµ–è§£æå¤±è´¥ã€‚è¯¥æœ¯è¯­æ”¯æŒåŠ¨æ€ç‰ˆæœ¬ã€‚

ä¸‹è¡¨è¯´æ˜äº†è®¸å¤šç”¨ä¾‹ä»¥åŠå¦‚ä½•ç»„åˆä¸åŒçš„æœ¯è¯­ä»¥è¿›è¡Œä¸°å¯Œç‰ˆæœ¬å£°æ˜ï¼š:

.Rich version use cases
[%header%autowidth,compact]
|===
| Which version(s) of this dependency are acceptable? | `strictly` | `require` | `prefer` | `rejects` | Selection result

| Tested with version `1.5`, believe all future versions should work.
|
| 1.5
|
|
| ä» `1.5` å¼€å§‹çš„ä»»ä½•ç‰ˆæœ¬ï¼Œç­‰æ•ˆäº `org:foo:1.5` . æ¥å—å‡çº§åˆ° `2.4`

| Tested with `1.5`, soft constraint upgrades according to semantic versioning.
|
| [1.0, 2.0[
| 1.5
|
| Any version between `1.0` and `2.0`, `1.5` if nobody else cares. An upgrade to `2.4` is accepted. +
ğŸ”’

| Tested with `1.5`, but follows semantic versioning.
| [1.0, 2.0[
|
| 1.5
|
| Any version between `1.0` and `2.0` excluded, `1.5` if nobody else cares. +
Overwrites versions from transitive dependencies. +
ğŸ”’

| Same as above, with `1.4` known broken.
| [1.0, 2.0[
|
| 1.5
| 1.4
| Any version between `1.0` and `2.0` excluded except for `1.4`, `1.5` if nobody else cares. +
Overwrites versions from transitive dependencies. +
ğŸ”’

| No opinion, works with `1.5`.
|
|
| 1.5
|
| `1.5` if no other opinion, any otherwise.

| No opinion, prefer latest release.
|
|
| `latest.release`
|
| The latest release at build time. +
ğŸ”’

| On the edge, latest release, no downgrade.
|
| `latest.release`
|
|
| The latest release at build time. +
ğŸ”’

| No other version than 1.5.
| 1.5
|
|
|
| 1.5, or failure if another `strict` or higher `require` constraint disagrees. +
Overwrites versions from transitive dependencies.

| `1.5` or a patch version of it exclusively.
| [1.5,1.6[
|
|
|
| Latest `1.5.x` patch release, or failure if another `strict` or higher `require` constraint disagrees. +
Overwrites versions from transitive dependencies. +
ğŸ”’
|===


å¸¦é” (ğŸ”’) çš„è¡Œè¡¨ç¤ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ <<dependency_locking.adoc#,dependency locking>> æ˜¯æœ‰æ„ä¹‰çš„ã€‚ ä¸ä¸°å¯Œç‰ˆæœ¬å£°æ˜æœ‰å…³çš„å¦ä¸€ä¸ªæ¦‚å¿µæ˜¯å‘å¸ƒ  <<publishing_maven.adoc#publishing_maven:resolved_dependencies,resolved versions>>è€Œä¸æ˜¯å·²å£°æ˜ç‰ˆæœ¬çš„èƒ½åŠ›ã€‚

ä½¿ç”¨ `strictly`ï¼ˆå°¤å…¶æ˜¯å¯¹äºåº“ï¼‰å¿…é¡»æ˜¯ä¸€ä¸ªæ·±æ€ç†Ÿè™‘çš„è¿‡ç¨‹ï¼Œå› ä¸ºå®ƒä¼šå¯¹ä¸‹æ¸¸ç”¨æˆ·äº§ç”Ÿå½±å“ã€‚ åŒæ—¶ï¼Œå¦‚æœä½¿ç”¨å¾—å½“ï¼Œå®ƒå°†æœ‰åŠ©äºæ¶ˆè´¹è€…äº†è§£å“ªäº›åº“ç»„åˆåœ¨å…¶ä¸Šä¸‹æ–‡ä¸­æ— æ³•ååŒå·¥ä½œã€‚ æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ <<dependency_downgrade_and_exclude.adoc#sec:enforcing_dependency_version,overriding dependency version>>ã€‚

[NOTE]
====
ä¸°å¯Œçš„ç‰ˆæœ¬ä¿¡æ¯å°†ä»¥ Gradle Module å…ƒæ•°æ®æ ¼å¼ä¿å­˜ã€‚ ä½†æ˜¯ï¼Œè½¬æ¢ä¸º Ivy æˆ– Maven å…ƒæ•°æ®æ ¼å¼å°†æ˜¯æœ‰æŸçš„ã€‚ æœ€é«˜çº§åˆ«å°†è¢«å‘å¸ƒï¼Œè¿™æ˜¯ `strictly` or `require` over `prefer`. æ­¤å¤–ï¼Œä»»ä½• `reject` éƒ½ä¼šè¢«å¿½ç•¥ã€‚
====

é€šè¿‡ä¾èµ–æˆ–çº¦æŸå£°æ˜ä¸­çš„ `version` DSL æ–¹æ³•è®¿é—®ä¸°å¯Œçš„ç‰ˆæœ¬å£°æ˜ï¼Œä»è€Œå¯ä»¥è®¿é—® link:{javadocPath}/org/gradle/api/artifacts/MutableVersionConstraint.html[MutableVersionConstraint]ã€‚

.Rich version declaration
====
include::{snippets-dir}/dependencyManagement/declaringDependencies-concreteVersion/groovy/build.gradle[tags=rich-version]
include::{snippets-dir}/dependencyManagement/declaringDependencies-concreteVersion/kotlin/build.gradle.kts[tags=rich-version]
====
