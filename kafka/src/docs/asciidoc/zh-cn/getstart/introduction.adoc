[[kafka-intro]]
= 介绍

[[kafka-intro-streaming]]
== 什么是事件流？

事件流就像人体中的中枢神经系统一样，它始终 “保持在线”。在当前的世界中，越来越多的企业开始定义软件的自动化，并且软件的用户更多的是软件

从技术上讲，事件流是从事件源（如数据库，传感器，移动设备，云服务以及软件应用程序等）以事件流的形式实时捕获数据的一种行为。并且将这些事件流进行存储，以便后面进行搜索。可以实时，回溯地操作和处理响应事件流。
并根据需要将事件流路由到不同的技术目标。因此，事件流确保了数据的流动性和演绎，以便正确的信息在正确的时间出现在正确的位置。

[[kafka-intro-usage]]
== 事件流可以干什么？

事件流应用于 {kafka-docs}/powered-by[众多行业和组织]。 它的许多例子包括：

* 实时处理支付和金融交易，例如在证券交易所、银行和保险中。
* 实时跟踪和监控汽车、卡车、车队和货运，例如在物流和汽车行业。
* 持续捕获和分析来自物联网设备或其他设备的传感器数据，例如工厂和风电场。
* 收集并立即响应客户互动和订单，例如零售、酒店和旅游行业以及移动应用程序。
* 监测住院病人，预测病情变化，确保在紧急情况下及时治疗。
* 连接、存储和提供公司不同部门产生的数据。
* 作为数据平台、事件驱动架构和微服务的基础。

[[kafka-intro-platform]]
== Apache Kafka® 是一个事件流平台。 这意味着什么？

Kafka 结合了三个关键特性，因此您可以通过一个经过 {kafka-docs}/powered-by[实战考验的解决方案] 实现端到端的事件流用例：

. 发布（写入）和订阅（读取）事件流，包括从其他系统持续导入/导出数据。
. 根据需要持久可靠地存储事件流。
. 在事件发生时或回溯时处理事件流。

所有这些功能都以分布式、高度可扩展、弹性、容错和安全的方式提供。 Kafka 可以部署在单机硬件、虚拟机和容器上，也可以部署在本地和云端。
您可以在自行管理 Kafka 环境和使用各种供应商提供的托管服务之间进行选择。

[[kafka-intro-nutshell]]
== 简而言之，Kafka 是如何工作的？

Kafka 是一个分布式系统，由服务端和客户端组成，它们之间通过高性能的 {kafka-docs}/protocol.html[TCP 网络协议] 进行通信。它可以部署在本地和云环境中的单机硬件、虚拟机和容器上。

**服务器**：Kafka 作为一个或多个服务器的集群运行，可以跨越多个数据中心或云区域。其中一些服务器形成存储层，称为 brokers。
其他服务器运行 <<kafka-connect,Kafka Connect>> 以将数据作为事件流持续导入和导出，将 Kafka 与您现有的系统（例如关系数据库以及其他 Kafka 集群）集成。
为了让您实现关键任务用例，Kafka 集群具有高度可扩展性和容错性：如果其中任何一个服务器出现故障，其他服务器将接管它们的工作，以确保持续运行而不会丢失任何数据。

**客户端**：允许您编写分布式应用程序和微服务，以并行、大规模和容错方式读取、写入和处理事件流，即使在网络问题或机器故障的情况下也是如此。
Kafka 附带了一些 https://cwiki.apache.org/confluence/display/KAFKA/Clients[客户端]，这些客户端由 Kafka 社区提供的数十个客户端增强：客户端可用于 Java 和 Scala，包括更高级别的 {kafka-docs}/documentation/streams/[Kafka Streams 库]，用于 Go、Python、C/C++ 和许多其他编程语言以及 REST API。

[[kafka-intro-concepts-and-terms]]
== 主要概念和术语

event（事件）记录了世界或您的业务中 "发生了某些事" 的事实。 在文档中也称为 record （记录） 或 message（消息）。 当您向 Kafka 读取或写入数据时，您将以事件的形式执行此操作。
从概念上讲，事件具有 key、value、timestamp 和可选的 metadata headers（元数据头）。 以下是一个示例事件：

[source,text]
----
Event key: "Alice"
Event value: "Made a payment of $200 to Bob"
Event timestamp: "Jun. 25, 2020 at 2:06 p.m."
----

Producers（生产者）是那些向 Kafka 发布（写入）事件的客户端应用程序，而 consumers （消费者）是订阅（读取和处理）这些事件的那些客户端应用程序。
在 Kafka 中，生产者和消费者完全解耦并且彼此不了解，这是实现 Kafka 具有高度可扩展性的关键。 例如，生产者永远不需要等待消费者。
Kafka 提供了各种 <<kafka-intro-guarantees,保证>>，例如一次性处理事件的能力。

事件被组织并持久地存储在主题中。这理解起来也很容易，主题就类似于文件系统中的文件夹，事件就是该文件夹中的文件。 例如主题名称可以是 "payments"。
Kafka 中的主题始终是多生产者和多订阅者：一个主题可以有零个、一个或多个向其写入事件的生产者，以及订阅这些事件的零个、一个或多个消费者。 主题中的事件可以根据需要随时读取 — 与传统的消息传递系统不同，事件在消费后不会被删除。
相反，您可以通过每个主题的配置设置来定义 Kafka 应该将您的事件保留多长时间，之后将旧事件丢弃。 Kafka 的性能在数据大小方面实际上是恒定的，因此长时间存储数据是非常好的。

主题是分区的，这意味着主题分布在位于不同 Kafka brokers 的多个 "buckets"  中。 数据的这种分布式放置对于可扩展性非常重要，因为它允许客户端应用程序同时从多个 brokers 读取和写入数据。
当一个新事件发布到一个主题时，它实际上是附加到主题的分区之一。 具有相同事件键（例如，客户或车辆 ID）的事件被写入同一个分区，并且 Kafka <<kafka-intro-guarantees,保证>> 给定主题分区的任何消费者将始终以与写入事件完全相同的顺序读取该分区的事件。

.此示例主题有四个分区 P1–P4。两个生产者客户端正在发布数据，它们之间彼此独立，通过网络将新事件发布到主题分区。具有相同 key 的事件（在图中由其颜色表示）将写入相同的分区。请注意，两个生产者都可以写入同一分区。
image::{image-dir}/streams-and-tables-p1_p4.png[]

为了使您的数据具有容错性和高可用性，可以复制每个主题，甚至跨区域或数据中心复制，这样就可以保证始终有多个 brokers 拥有数据副本，以防万一出现问题，您想要对 brokers进行维护等等。
一个常见的生产设置是将  replication factor（副本因子） 设置为 3，即始终存在三个数据副本。 此副本在主题分区级别执行。

这本入门书应该足以进行介绍。 如果您有兴趣，文档的 <<kafka-design,设计>> 部分会详细解释 Kafka 的各种概念。

[[kafka-intro-apis]]
== Kafka APIs

除了用于管理和管理员任务的命令行工具外，Kafka 还具有 5 个用于 Java 和 Scala 的核心 API。

* <<kafka-admin-api,Admin API>> 用于管理和检查主题，brokers 和其他 Kafka 对象。
* <<kafka-producer-api,Producer API>> 用于将事件流发布（写入）一个或多个 Kafka 主题
* <<kafka-consumer-api,Consumer API>> 用于订阅（读取）一个或多个主题，并处理发布给他们的事件流。
* {kafka-docs}/documentation/streams/[Kafka Streams API] 用于实现对应用程序和微服务的流处理. 它提供了更高级的功能来处理事件流, 包括转换，有状态的操作如 连接，窗口化，基于事件时间的处理等等。从一个或多个主题读取输入，然后生成一个或多个主题的输出，有效地将输入流转换为输出流
* <<kafka-connect-api,Kafka Connect API>> 用于构建和运行可重复使用的数据导入/导出连接器。这些连接器可以可以消费（读取）或发布（写入）来自外部系统和应用程序的事件流，以便他们可以和 Kafka 集成。例如：连接到关系型数据库（例如：PostgreSQL） 的连接器可能会捕捉对一组表的所有变更。
但是，实际上，您通常不需要实现自己的连接器，因为 Kafka 社区已经提供了数百个现成的连接器。

[[kafka-intro-more]]
== 接下来

* 要获取 Kafka 的实践经验，请遵循 {kafka-docs}/quickstart[快速入门]
* 要更加详细地了解 Kafka，请阅读 {kafka-docs}/documentation/[文档]。您还可以选择 {kafka-docs}/books-and-papers[Kafka 书籍和学术论文]
* 浏览用例，了解我们全球社区中的其他用户如何从 Kafka 中获得价值
* 加入 {kafka-docs}/events[当地的 Kafka 小组]，观看 https://www.kafka-summit.org/past-events[Kafka 社区主要会议 Kafka 峰会的演讲]。